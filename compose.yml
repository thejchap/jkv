version: "3.8"
services:
  leader:
    build:
      dockerfile: Dockerfile.leader
    command:
      - jkv
      - --volumes
      - http://jkv-volume-1:8000,http://jkv-volume-2:8000,http://jkv-volume-3:8000
    ports:
      - "3000:8000"
    environment:
      - ROCKET_ADDRESS=0.0.0.0
      - RUST_LOG=info
  volume:
    deploy:
      replicas: 3
    build:
      dockerfile: Dockerfile.volume
